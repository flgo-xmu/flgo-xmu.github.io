
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../empty/">
      
      
        <link rel="next" href="../visualization/">
      
      <link rel="icon" href="../../../../img/flgo_icon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>flgo.benchmark.toolkits.partition - FLGo</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flgo.benchmark.toolkits.partition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="FLGo" class="md-header__button md-logo" aria-label="FLGo" data-md-component="logo">
      
  <img src="../../../../img/f.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FLGo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              flgo.benchmark.toolkits.partition
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="/cn/" hreflang="cn" class="md-select__link">
                    中文
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../getting_started/" class="md-tabs__link">
      Get Started
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../Overview/" class="md-tabs__link">
        Overview
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../FLGo/" class="md-tabs__link md-tabs__link--active">
        Docs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../Tutorials/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../Resources/" class="md-tabs__link">
        Resources
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://github.com/WwZzz/easyFL" class="md-tabs__link">
      Github
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="FLGo" class="md-nav__button md-logo" aria-label="FLGo" data-md-component="logo">
      
  <img src="../../../../img/f.png" alt="logo">

    </a>
    FLGo
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/" class="md-nav__link">
        Get Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Overview/">Overview</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Overview/Architecture/">Architecture</a>
          
            <label for="__nav_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Overview/Architecture/benchmark/" class="md-nav__link">
        Benchmark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Overview/Architecture/algorithm/" class="md-nav__link">
        Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Overview/Architecture/experiment/" class="md-nav__link">
        Experiment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Overview/Architecture/simulator/" class="md-nav__link">
        Simulator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../FLGo/" class="md-nav__link">
        FLGo
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../algorithm/">flgo.algorithm</a>
          
            <label for="__nav_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          flgo.algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithm/fedbase/" class="md-nav__link">
        flgo.algorithm.fedbase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithm/vflbase/" class="md-nav__link">
        flgo.algorithm.vflbase
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">flgo.benchmark</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          flgo.benchmark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../base/" class="md-nav__link">
        flgo.benchmark.base
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
          flgo.benchmark.toolkits
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          flgo.benchmark.toolkits
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3_3_1" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../cv/">flgo.benchmark.toolkits.cv</a>
          
            <label for="__nav_3_3_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          flgo.benchmark.toolkits.cv
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cv/classification/" class="md-nav__link">
        classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cv/segmentation/" class="md-nav__link">
        segmentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cv/detection/" class="md-nav__link">
        detection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3_3_2" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../nlp/">flgo.benchmark.toolkits.nlp</a>
          
            <label for="__nav_3_3_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          flgo.benchmark.toolkits.nlp
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp/classification/" class="md-nav__link">
        classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp/language_modeling/" class="md-nav__link">
        language_modeling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp/translation/" class="md-nav__link">
        translation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3_3_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../graph/">flgo.benchmark.toolkits.graph</a>
          
            <label for="__nav_3_3_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          flgo.benchmark.toolkits.graph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/node_classification/" class="md-nav__link">
        node_classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/graph_classification/" class="md-nav__link">
        graph_classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/link_prediction/" class="md-nav__link">
        link_prediction
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../empty/" class="md-nav__link">
        flgo.benchmark.toolkits.tabular
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          flgo.benchmark.toolkits.partition
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        flgo.benchmark.toolkits.partition
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition" class="md-nav__link">
    flgo.benchmark.toolkits.partition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner" class="md-nav__link">
    BasicPartitioner
  </a>
  
    <nav class="md-nav" aria-label="BasicPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner.data_imbalance_generator" class="md-nav__link">
    data_imbalance_generator()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner.register_generator" class="md-nav__link">
    register_generator()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.DirichletPartitioner" class="md-nav__link">
    DirichletPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.DiversityPartitioner" class="md-nav__link">
    DiversityPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.GaussianPerturbationPartitioner" class="md-nav__link">
    GaussianPerturbationPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.IDPartitioner" class="md-nav__link">
    IDPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.IIDPartitioner" class="md-nav__link">
    IIDPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.NodeLouvainPartitioner" class="md-nav__link">
    NodeLouvainPartitioner
  </a>
  
    <nav class="md-nav" aria-label="NodeLouvainPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.NodeLouvainPartitioner.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner" class="md-nav__link">
    VerticalSplittedPartitioner
  </a>
  
    <nav class="md-nav" aria-label="VerticalSplittedPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner.integer_k_partition" class="md-nav__link">
    integer_k_partition()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        flgo.benchmark.toolkits.visualization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../experiment/">flgo.experiment</a>
          
            <label for="__nav_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          flgo.experiment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
          flgo.experiment.logger
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4_2">
          <span class="md-nav__icon md-icon"></span>
          flgo.experiment.logger
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../experiment/logger/BasicLogger/" class="md-nav__link">
        BasicLogger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../experiment/analyzer/" class="md-nav__link">
        flgo.experiment.analyzer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../experiment/device_scheduler/" class="md-nav__link">
        flgo.experiment.device_scheduler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../simulator/">flgo.simulator</a>
          
            <label for="__nav_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          flgo.simulator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../simulator/base/" class="md-nav__link">
        flgo.simulator.base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../simulator/default_simulator/" class="md-nav__link">
        flgo.simulator.default_simulator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../utils/">flgo.utils</a>
          
            <label for="__nav_3_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          flgo.utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/fflow/" class="md-nav__link">
        flgo.utils.fflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/fmodule/" class="md-nav__link">
        flgo.utils.fmodule
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/">Tutorials</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/0_Quick_Start/">0 Quick Start</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          0 Quick Start
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/1_Configuration/">1 Configuration</a>
          
            <label for="__nav_4_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          1 Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.1_FL_Descriptor/" class="md-nav__link">
        1.1 FL Descriptor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.2_Option_Configuration/" class="md-nav__link">
        1.2 Option Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.3_Task_Configuration/" class="md-nav__link">
        1.3 Task Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.4_Algorithm_Configuration/" class="md-nav__link">
        1.4 Algorithm Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.5_Model_Configuration/" class="md-nav__link">
        1.5 Model Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/1_Configuration/1.6_Logger_Configuration/" class="md-nav__link">
        1.6 Logger Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/2_Algorithm_Customization/">2 Algorithm Customization</a>
          
            <label for="__nav_4_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          2 Algorithm Customization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/2_Algorithm_Customization/2.1_General_Paradigm/" class="md-nav__link">
        2.1 General Paradigm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Tutorials/2_Algorithm_Customization/2.2_Local_Training_FedProx/" class="md-nav__link">
        2.2 Local Training
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/3_Benchmark_Customization/">3 Benchmark Customization</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          3 Benchmark Customization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_6" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Tutorials/4_Simulator_Customization/">4 Simulator Customization</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          4 Simulator Customization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Resources/">Resources</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Resources/algorithm/">Algorithm</a>
          
            <label for="__nav_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/algorithm/horizontal/" class="md-nav__link">
        Horizontal
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Resources/benchmark/">Benchmark</a>
          
            <label for="__nav_5_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Benchmark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3_2" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3_2" id="__nav_5_3_2_label" tabindex="0">
          Image
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3_2">
          <span class="md-nav__icon md-icon"></span>
          Image
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Image/classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Image/detection/" class="md-nav__link">
        Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Image/segmentation/" class="md-nav__link">
        Segmentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3_3" id="__nav_5_3_3_label" tabindex="0">
          Text
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3_3">
          <span class="md-nav__icon md-icon"></span>
          Text
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Text/classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Text/translation/" class="md-nav__link">
        Translation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Text/language_modeling/" class="md-nav__link">
        Language Modeling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3_4" id="__nav_5_3_4_label" tabindex="0">
          Graph
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3_4">
          <span class="md-nav__icon md-icon"></span>
          Graph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Graph/graph_classification/" class="md-nav__link">
        Graph Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Graph/node_classification/" class="md-nav__link">
        Node Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Resources/benchmark/Graph/link_prediction/" class="md-nav__link">
        Link Prediction
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../Resources/simulator/">Simulator</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Simulator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/WwZzz/easyFL" class="md-nav__link">
        Github
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition" class="md-nav__link">
    flgo.benchmark.toolkits.partition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner" class="md-nav__link">
    BasicPartitioner
  </a>
  
    <nav class="md-nav" aria-label="BasicPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner.data_imbalance_generator" class="md-nav__link">
    data_imbalance_generator()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.BasicPartitioner.register_generator" class="md-nav__link">
    register_generator()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.DirichletPartitioner" class="md-nav__link">
    DirichletPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.DiversityPartitioner" class="md-nav__link">
    DiversityPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.GaussianPerturbationPartitioner" class="md-nav__link">
    GaussianPerturbationPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.IDPartitioner" class="md-nav__link">
    IDPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.IIDPartitioner" class="md-nav__link">
    IIDPartitioner
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.NodeLouvainPartitioner" class="md-nav__link">
    NodeLouvainPartitioner
  </a>
  
    <nav class="md-nav" aria-label="NodeLouvainPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.NodeLouvainPartitioner.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner" class="md-nav__link">
    VerticalSplittedPartitioner
  </a>
  
    <nav class="md-nav" aria-label="VerticalSplittedPartitioner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner.integer_k_partition" class="md-nav__link">
    integer_k_partition()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>flgo.benchmark.toolkits.partition</h1>

<div class="doc doc-object doc-module">


<a id="flgo.benchmark.toolkits.partition"></a>
  <div class="doc doc-contents first">
  
      <p>This file contains preset partitioners for the benchmarks.
All the Partitioner should implement the method <code>__call__(self, data)</code>
where <code>data</code> is the dataset to be partitioned and the return is a list of the partitioned result.</p>
<p>For example, The IIDPartitioner.<strong>call</strong> receives a indexable object (i.e. instance of torchvision.datasets.mnsit.MNSIT)
and I.I.D. selects samples' indices in the original dataset as each client's local_movielens_recommendation data.
The list of list of sample indices are finally returnerd (e.g. [[0,1,2,...,1008], ...,[25,23,98,...,997]]).</p>
<p>To use the partitioner, you can specify Partitioner in the configuration dict for <code>flgo.gen_task</code>.
 Example 1: passing the parameter of <strong>init</strong> of the Partitioner through the dict <code>para</code></p>
<blockquote>
<blockquote>
<blockquote>
<p>import flgo
config = {'benchmark':{'name':'flgo.benchmark.mnist_classification'},
...            'partitioner':{'name':'IIDPartitioner', 'para':{'num_clients':20, 'alpha':1.0}}}
flgo.gen_task(config, './test_partition')</p>
</blockquote>
</blockquote>
</blockquote>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.BasicPartitioner" class="doc doc-heading">
        <code>BasicPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="flgo.benchmark.toolkits.partition.AbstractPartitioner">AbstractPartitioner</span></code></p>

  
      <p>This is the basic class of data partitioner. The partitioner will be directly called by the
task generator of different benchmarks. By overwriting <strong>call</strong> method, different partitioners
can be realized. The input of <strong>call</strong> is usually a dataset.</p>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BasicPartitioner</span><span class="p">(</span><span class="n">AbstractPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is the basic class of data partitioner. The partitioner will be directly called by the</span>
<span class="sd">    task generator of different benchmarks. By overwriting __call__ method, different partitioners</span>
<span class="sd">    can be realized. The input of __call__ is usually a dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">register_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Register the generator as an self&#39;s attribute&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>

    <span class="k">def</span> <span class="nf">data_imbalance_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="p">,</span> <span class="n">datasize</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split the data size into several parts</span>

<span class="sd">        Args:</span>
<span class="sd">            num_clients (int): the number of clients</span>
<span class="sd">            datasize (int): the total data size</span>
<span class="sd">            imbalance (float): the degree of data imbalance across clients</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list of integer numbers that represents local_movielens_recommendation data sizes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">imbalance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">samples_per_client</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">datasize</span> <span class="o">/</span> <span class="n">num_clients</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clients</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">datasize</span> <span class="o">%</span> <span class="n">num_clients</span><span class="p">):</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">imbalance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">imbalance</span><span class="p">)</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="n">imbalance</span>
            <span class="n">mean_datasize</span> <span class="o">=</span> <span class="n">datasize</span> <span class="o">/</span> <span class="n">num_clients</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mean_datasize</span><span class="p">)</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="n">samples_per_client</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="n">num_clients</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">thresold</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imbalance</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">datasize</span> <span class="o">-</span> <span class="n">num_clients</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">thresold</span><span class="p">)</span>
            <span class="n">crt_data_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
            <span class="c1"># force current data size to match the total data size</span>
            <span class="k">while</span> <span class="n">crt_data_size</span> <span class="o">!=</span> <span class="n">datasize</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;=</span> <span class="n">thresold</span><span class="p">:</span>
                    <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">maxvol</span> <span class="o">=</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span>
                    <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                    <span class="k">while</span> <span class="nb">min</span><span class="p">(</span><span class="n">new_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxvol</span><span class="p">:</span>
                        <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                    <span class="n">new_size_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_samples</span><span class="p">])</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_samples</span><span class="p">[</span><span class="n">new_size_id</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;=</span> <span class="n">delta</span><span class="p">:</span>
                    <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span>
                <span class="k">elif</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span> <span class="o">&gt;=</span> <span class="n">thresold</span><span class="p">:</span>
                    <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">minvol</span> <span class="o">=</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span>
                    <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                    <span class="k">while</span> <span class="nb">max</span><span class="p">(</span><span class="n">new_samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minvol</span><span class="p">:</span>
                        <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                    <span class="n">new_size_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_samples</span><span class="p">])</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_samples</span><span class="p">[</span><span class="n">new_size_id</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span> <span class="o">&gt;=</span> <span class="n">delta</span><span class="p">:</span>
                    <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                    <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span><span class="p">)</span>
                <span class="n">crt_data_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">samples_per_client</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="flgo.benchmark.toolkits.partition.BasicPartitioner.data_imbalance_generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">data_imbalance_generator</span><span class="p">(</span><span class="n">num_clients</span><span class="p">,</span> <span class="n">datasize</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Split the data size into several parts</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>datasize</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the total data size</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of data imbalance across clients</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>a list of integer numbers that represents local_movielens_recommendation data sizes</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">data_imbalance_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="p">,</span> <span class="n">datasize</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the data size into several parts</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int): the number of clients</span>
<span class="sd">        datasize (int): the total data size</span>
<span class="sd">        imbalance (float): the degree of data imbalance across clients</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of integer numbers that represents local_movielens_recommendation data sizes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">imbalance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">samples_per_client</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">datasize</span> <span class="o">/</span> <span class="n">num_clients</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">datasize</span> <span class="o">%</span> <span class="n">num_clients</span><span class="p">):</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">imbalance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">imbalance</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">imbalance</span>
        <span class="n">mean_datasize</span> <span class="o">=</span> <span class="n">datasize</span> <span class="o">/</span> <span class="n">num_clients</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mean_datasize</span><span class="p">)</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">samples_per_client</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="n">num_clients</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">thresold</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imbalance</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">datasize</span> <span class="o">-</span> <span class="n">num_clients</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">thresold</span><span class="p">)</span>
        <span class="n">crt_data_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
        <span class="c1"># force current data size to match the total data size</span>
        <span class="k">while</span> <span class="n">crt_data_size</span> <span class="o">!=</span> <span class="n">datasize</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;=</span> <span class="n">thresold</span><span class="p">:</span>
                <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">maxvol</span> <span class="o">=</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span>
                <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                <span class="k">while</span> <span class="nb">min</span><span class="p">(</span><span class="n">new_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxvol</span><span class="p">:</span>
                    <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                <span class="n">new_size_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_samples</span><span class="p">])</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_samples</span><span class="p">[</span><span class="n">new_size_id</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;=</span> <span class="n">delta</span><span class="p">:</span>
                <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span>
            <span class="k">elif</span> <span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">maxid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">maxid</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span> <span class="o">&gt;=</span> <span class="n">thresold</span><span class="p">:</span>
                <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">minvol</span> <span class="o">=</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span>
                <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                <span class="k">while</span> <span class="nb">max</span><span class="p">(</span><span class="n">new_samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minvol</span><span class="p">:</span>
                    <span class="n">new_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">num_clients</span><span class="p">))</span>
                <span class="n">new_size_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">crt_data_size</span> <span class="o">-</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span> <span class="o">-</span> <span class="n">datasize</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_samples</span><span class="p">])</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_samples</span><span class="p">[</span><span class="n">new_size_id</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span> <span class="o">&gt;=</span> <span class="n">delta</span><span class="p">:</span>
                <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
                <span class="n">samples_per_client</span><span class="p">[</span><span class="n">minid</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">datasize</span> <span class="o">-</span> <span class="n">crt_data_size</span><span class="p">)</span>
            <span class="n">crt_data_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">samples_per_client</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="flgo.benchmark.toolkits.partition.BasicPartitioner.register_generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">register_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Register the generator as an self's attribute</p>

      <details class="quote">
        <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Register the generator as an self&#39;s attribute&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.DirichletPartitioner" class="doc doc-heading">
        <code>DirichletPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>`Partition the indices of samples in the original dataset according to Dirichlet distribution of the
particular attribute. This way of partition is widely used by existing works in federated learning.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p><code>alpha</code>(i.e. alpha&gt;=0) in Dir(alpha*p) where p is the global distribution. The smaller alpha is, the higher heterogeneity the data is.</p></td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>error_bar</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the allowed error when the generated distribution mismatches the distirbution that is actually wanted, since there may be no solution for particular imbalance and alpha.</p></td>
          <td>
                <code>1e-06</code>
          </td>
        </tr>
        <tr>
          <td><code>index_func</code></td>
          <td>
                <code>func</code>
          </td>
          <td><p>to index the distribution-dependent (i.e. label) attribute in each sample.</p></td>
          <td>
                <code>lambda X: [xi[-1] for xi in X]</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DirichletPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices of samples in the original dataset according to Dirichlet distribution of the</span>
<span class="sd">    particular attribute. This way of partition is widely used by existing works in federated learning.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int, optional): the number of clients</span>
<span class="sd">        alpha (float, optional): `alpha`(i.e. alpha&gt;=0) in Dir(alpha*p) where p is the global distribution. The smaller alpha is, the higher heterogeneity the data is.</span>
<span class="sd">        imbalance (float, optional): the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</span>
<span class="sd">        error_bar (float, optional): the allowed error when the generated distribution mismatches the distirbution that is actually wanted, since there may be no solution for particular imbalance and alpha.</span>
<span class="sd">        index_func (func, optional): to index the distribution-dependent (i.e. label) attribute in each sample.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">error_bar</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">X</span><span class="p">:[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="n">num_clients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">=</span> <span class="n">imbalance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span> <span class="o">=</span> <span class="n">index_func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_bar</span> <span class="o">=</span> <span class="n">error_bar</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dir</span><span class="si">{:.2f}</span><span class="s2">_err</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_bar</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s1">&#39;_imb</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">num_attrs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">attrs</span><span class="p">))</span>
        <span class="n">samples_per_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_imbalance_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="c1"># count the label distribution</span>
        <span class="n">lb_counter</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
        <span class="n">lb_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lb_counter</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lb_counter</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">lb_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">lb</span> <span class="ow">in</span> <span class="n">lb_names</span><span class="p">:</span>
            <span class="n">lb_dict</span><span class="p">[</span><span class="n">lb</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">attrs</span> <span class="o">==</span> <span class="n">lb</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">proportions</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">proportions</span><span class="p">)):</span>
            <span class="n">proportions</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="n">sorted_cid_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">),</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)])}</span>
        <span class="n">error_increase_interval</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">max_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_bar</span>
        <span class="n">loop_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">crt_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">crt_error</span> <span class="o">=</span> <span class="mi">100000</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loop_count</span> <span class="o">&gt;=</span> <span class="n">error_increase_interval</span><span class="p">:</span>
                <span class="n">loop_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">max_error</span> <span class="o">=</span> <span class="n">max_error</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="c1"># generate dirichlet distribution till ||E(proportion) - P(D)||&lt;=1e-5*self.num_classes</span>
            <span class="n">mean_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">pi</span> <span class="o">*</span> <span class="n">di</span> <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">proportions</span><span class="p">,</span> <span class="n">samples_per_client</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">mean_prop</span> <span class="o">=</span> <span class="n">mean_prop</span> <span class="o">/</span> <span class="n">mean_prop</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">error_norm</span> <span class="o">=</span> <span class="p">((</span><span class="n">mean_prop</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">crt_error</span> <span class="o">-</span> <span class="n">error_norm</span> <span class="o">&gt;=</span> <span class="n">max_error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">{:.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error_norm</span><span class="p">))</span>
                <span class="n">crt_error</span> <span class="o">=</span> <span class="n">error_norm</span>
            <span class="k">if</span> <span class="n">error_norm</span> <span class="o">&lt;=</span> <span class="n">max_error</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">excid</span> <span class="o">=</span> <span class="n">sorted_cid_map</span><span class="p">[</span><span class="n">crt_id</span><span class="p">]</span>
            <span class="n">crt_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">crt_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span>
            <span class="n">sup_prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
            <span class="n">del_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">pi</span> <span class="o">*</span> <span class="n">di</span> <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">proportions</span><span class="p">,</span> <span class="n">samples_per_client</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">del_prop</span> <span class="o">-=</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">excid</span><span class="p">]</span> <span class="o">*</span> <span class="n">proportions</span><span class="p">[</span><span class="n">excid</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">error_increase_interval</span> <span class="o">-</span> <span class="n">loop_count</span><span class="p">):</span>
                <span class="n">alter_norms</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sup_prop</span><span class="p">[</span><span class="n">cid</span><span class="p">])):</span>
                        <span class="k">continue</span>
                    <span class="n">alter_prop</span> <span class="o">=</span> <span class="n">del_prop</span> <span class="o">+</span> <span class="n">samples_per_client</span><span class="p">[</span><span class="n">excid</span><span class="p">]</span> <span class="o">*</span> <span class="n">sup_prop</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span>
                    <span class="n">alter_prop</span> <span class="o">=</span> <span class="n">alter_prop</span> <span class="o">/</span> <span class="n">alter_prop</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="n">error_alter</span> <span class="o">=</span> <span class="p">((</span><span class="n">alter_prop</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="n">alter_norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_alter</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">alter_norms</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">error_norm</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">alter_norms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">alter_norms</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">error_norm</span><span class="p">:</span>
                <span class="n">alcid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">alter_norms</span><span class="p">)</span>
                <span class="n">proportions</span><span class="p">[</span><span class="n">excid</span><span class="p">]</span> <span class="o">=</span> <span class="n">sup_prop</span><span class="p">[</span><span class="n">alcid</span><span class="p">]</span>
            <span class="n">loop_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_dist</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># for efficiently visualizing</span>
        <span class="k">for</span> <span class="n">lb</span> <span class="ow">in</span> <span class="n">lb_names</span><span class="p">:</span>
            <span class="n">lb_idxs</span> <span class="o">=</span> <span class="n">lb_dict</span><span class="p">[</span><span class="n">lb</span><span class="p">]</span>
            <span class="n">lb_proportion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pi</span><span class="p">[</span><span class="n">lb_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">lb</span><span class="p">)]</span> <span class="o">*</span> <span class="n">si</span> <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">proportions</span><span class="p">,</span> <span class="n">samples_per_client</span><span class="p">)])</span>
            <span class="n">lb_proportion</span> <span class="o">=</span> <span class="n">lb_proportion</span> <span class="o">/</span> <span class="n">lb_proportion</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">lb_proportion</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">lb_proportion</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lb_idxs</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">lb_datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">lb_idxs</span><span class="p">,</span> <span class="n">lb_proportion</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_dist</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">lb_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">lb_data</span> <span class="ow">in</span> <span class="n">lb_datas</span><span class="p">])</span>
            <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[</span><span class="n">local_data</span> <span class="o">+</span> <span class="n">lb_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">local_data</span><span class="p">,</span> <span class="n">lb_data</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">local_datas</span><span class="p">,</span> <span class="n">lb_datas</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_dist</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">local_datas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_datas</span> <span class="o">=</span> <span class="n">local_datas</span>
        <span class="k">return</span> <span class="n">local_datas</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.DiversityPartitioner" class="doc doc-heading">
        <code>DiversityPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>`Partition the indices of samples in the original dataset according to numbers of types of a particular
attribute (e.g. label) . This way of partition is widely used by existing works in federated learning.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
        <tr>
          <td><code>diversity</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the ratio of locally owned types of the attributes (i.e. the actual number=diversity * total_num_of_types)</p></td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index_func</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the index of the distribution-dependent (i.e. label) attribute in each sample.</p></td>
          <td>
                <code>lambda X: [xi[-1] for xi in X]</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DiversityPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices of samples in the original dataset according to numbers of types of a particular</span>
<span class="sd">    attribute (e.g. label) . This way of partition is widely used by existing works in federated learning.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int, optional): the number of clients</span>
<span class="sd">        diversity (float, optional): the ratio of locally owned types of the attributes (i.e. the actual number=diversity * total_num_of_types)</span>
<span class="sd">        imbalance (float, optional): the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</span>
<span class="sd">        index_func (int, optional): the index of the distribution-dependent (i.e. label) attribute in each sample.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">diversity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">index_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">X</span><span class="p">:[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="n">num_clients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diversity</span> <span class="o">=</span> <span class="n">diversity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span> <span class="o">=</span> <span class="n">index_func</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;div</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diversity</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
        <span class="n">dpairs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">did</span><span class="p">,</span> <span class="n">lb</span><span class="p">]</span> <span class="k">for</span> <span class="n">did</span><span class="p">,</span> <span class="n">lb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))),</span> <span class="n">labels</span><span class="p">)]</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diversity</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">num_classes</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="n">K</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
                <span class="n">idx_k</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dpairs</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">idx_k</span><span class="p">)</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">idx_k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span>
                    <span class="n">local_datas</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)]</span>
            <span class="n">contain</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span>
                <span class="n">current</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">num</span><span class="p">):</span>
                    <span class="n">mintime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">times</span> <span class="o">==</span> <span class="n">mintime</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current</span><span class="p">):</span>
                        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
                        <span class="n">current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                        <span class="n">times</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">contain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
                <span class="n">idx_k</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dpairs</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">idx_k</span><span class="p">)</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">idx_k</span><span class="p">,</span> <span class="n">times</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">contain</span><span class="p">[</span><span class="n">cid</span><span class="p">]:</span>
                        <span class="n">local_datas</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
                        <span class="n">ids</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">local_datas</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.GaussianPerturbationPartitioner" class="doc doc-heading">
        <code>GaussianPerturbationPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>`Partition the indices of samples I.I.D. and bind additional and static gaussian noise to each sample, which is
a setting of feature skew in federated learning.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of feature skew</p></td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the standard deviation of noise</p></td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>index_func</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the index of the feature to be processed for each sample.</p></td>
          <td>
                <code>lambda X: [xi[0] for xi in X]</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GaussianPerturbationPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices of samples I.I.D. and bind additional and static gaussian noise to each sample, which is</span>
<span class="sd">    a setting of feature skew in federated learning.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int, optional): the number of clients</span>
<span class="sd">        imbalance (float, optional): the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</span>
<span class="sd">        sigma (float, optional): the degree of feature skew</span>
<span class="sd">        scale (float, optional): the standard deviation of noise</span>
<span class="sd">        index_func (int, optional): the index of the feature to be processed for each sample.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">index_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">X</span><span class="p">:[</span><span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="n">num_clients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">=</span> <span class="n">imbalance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span> <span class="o">=</span> <span class="n">index_func</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;perturb_gs</span><span class="si">{:.1f}</span><span class="s2">_</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s1">&#39;_imb</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_func</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">samples_per_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_imbalance_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="n">d_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">d_idxs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[</span><span class="n">di</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">local_datas</span><span class="p">]</span>
        <span class="n">local_perturbation_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="n">local_perturbation_stds</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="n">local_perturbation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">):</span>
            <span class="n">c_perturbation</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">local_perturbation_means</span><span class="p">[</span><span class="n">cid</span><span class="p">],</span> <span class="n">local_perturbation_stds</span><span class="p">[</span><span class="n">cid</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span>
                              <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">local_datas</span><span class="p">[</span><span class="n">cid</span><span class="p">]))]</span>
            <span class="n">local_perturbation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_perturbation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_perturbation</span> <span class="o">=</span> <span class="n">local_perturbation</span>
        <span class="k">return</span> <span class="n">local_datas</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.IDPartitioner" class="doc doc-heading">
        <code>IDPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p><code>Partition the indices of samples I.I.D. according to the ID of each sample, which requires the passed parameter</code>data<code>has attribution</code>id`.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>priority</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The value should be in set ('random', 'max', 'min'). If the number of clients is smaller than the total number of all the clients, this term will decide the selected clients according to their local_movielens_recommendation data sizes.</p></td>
          <td>
                <code>&#39;random&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IDPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices of samples I.I.D. according to the ID of each sample, which requires the passed parameter</span>
<span class="sd">    `data` has attribution `id`.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int, optional): the number of clients</span>
<span class="sd">        priority (str, optional): The value should be in set (&#39;random&#39;, &#39;max&#39;, &#39;min&#39;). If the number of clients is smaller than the total number of all the clients, this term will decide the selected clients according to their local_movielens_recommendation data sizes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">index_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">X</span><span class="p">:</span><span class="n">X</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_clients</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorty</span> <span class="o">=</span> <span class="n">priority</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span> <span class="o">=</span> <span class="n">index_func</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;id&#39;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
        <span class="n">data_owners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_func</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_data</span><span class="p">)):</span>
            <span class="n">local_datas</span><span class="p">[</span><span class="n">data_owners</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">local_datas</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">local_datas</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">priorty</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
            <span class="n">local_datas</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">local_datas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">priorty</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
            <span class="n">local_datas</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">local_datas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))[:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">priorty</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">local_datas</span><span class="p">)</span>
            <span class="n">local_datas</span> <span class="o">=</span> <span class="n">local_datas</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">]</span>
        <span class="c1"># local_datas = sorted(local_datas, key=lambda x:data[x[0]][self.index_func] if self.index_func is not None else data.id[x[0]])</span>
        <span class="k">return</span> <span class="n">local_datas</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.IIDPartitioner" class="doc doc-heading">
        <code>IIDPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>`Partition the indices of samples in the original dataset indentically and independently.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_clients</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of clients</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IIDPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices of samples in the original dataset indentically and independently.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_clients (int, optional): the number of clients</span>
<span class="sd">        imbalance (float, optional): the degree of imbalance of the amounts of different local_movielens_recommendation data (0&lt;=imbalance&lt;=1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="n">num_clients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">=</span> <span class="n">imbalance</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;iid&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s1">&#39;_imb</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">samples_per_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_imbalance_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="n">d_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">d_idxs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">samples_per_client</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[</span><span class="n">di</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">local_datas</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">local_datas</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.NodeLouvainPartitioner" class="doc doc-heading">
        <code>NodeLouvainPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>Partition a graph into several subgraph by louvain algorithms. The input
of this partitioner should be of type networkx.Graph</p>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NodeLouvainPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Partition a graph into several subgraph by louvain algorithms. The input</span>
<span class="sd">    of this partitioner should be of type networkx.Graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_clients</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span> <span class="o">=</span> <span class="n">num_clients</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Louvain&quot;</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partition graph data by Louvain algorithm and similar nodes (i.e. being of the same community) will be</span>
<span class="sd">        allocated one client.</span>
<span class="sd">        Args:</span>
<span class="sd">            data (networkx.Graph):</span>
<span class="sd">        Returns:</span>
<span class="sd">            local_nodes (List): the local nodes id owned by each client (e.g. [[1,2], [3,4]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_nodes</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_groups</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ni</span><span class="p">,</span> <span class="n">gi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">groups</span><span class="p">[</span><span class="n">gi</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)))}</span>
        <span class="c1"># ensure the number of groups is larger than the number of clients</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">:</span>
            <span class="c1"># find the group with the largest size</span>
            <span class="n">groups_lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))]</span>
            <span class="n">max_gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
            <span class="c1"># set the size of the new group</span>
            <span class="n">min_glen</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
            <span class="n">max_glen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">max_glen</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">min_glen</span><span class="p">:</span> <span class="n">min_glen</span> <span class="o">=</span> <span class="n">max_glen</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="c1"># split the group with the largest size into two groups</span>
            <span class="n">nodes_in_gi</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">max_gi</span><span class="p">]</span>
            <span class="n">new_group_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
            <span class="n">groups</span><span class="p">[</span><span class="n">new_group_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_in_gi</span><span class="p">[:</span><span class="n">min_glen</span><span class="p">]</span>
            <span class="n">groups</span><span class="p">[</span><span class="n">max_gi</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_in_gi</span><span class="p">[</span><span class="n">min_glen</span><span class="p">:]</span>
        <span class="c1"># allocate different groups to clients</span>
        <span class="n">groups_lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))]</span>
        <span class="n">group_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">gi</span> <span class="ow">in</span> <span class="n">group_ids</span><span class="p">:</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">li</span><span class="p">)</span> <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">local_nodes</span><span class="p">])</span>
            <span class="n">local_nodes</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">gi</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">local_nodes</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="flgo.benchmark.toolkits.partition.NodeLouvainPartitioner.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Partition graph data by Louvain algorithm and similar nodes (i.e. being of the same community) will be
allocated one client.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>networkx.<span title="networkx.Graph">Graph</span></code>
          </td>
          <td></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>local_nodes</code></td>          <td>
                <code>List</code>
          </td>
          <td><p>the local nodes id owned by each client (e.g. [[1,2], [3,4]])</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Partition graph data by Louvain algorithm and similar nodes (i.e. being of the same community) will be</span>
<span class="sd">    allocated one client.</span>
<span class="sd">    Args:</span>
<span class="sd">        data (networkx.Graph):</span>
<span class="sd">    Returns:</span>
<span class="sd">        local_nodes (List): the local nodes id owned by each client (e.g. [[1,2], [3,4]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">local_nodes</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">)]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">node_groups</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ni</span><span class="p">,</span> <span class="n">gi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">groups</span><span class="p">[</span><span class="n">gi</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)))}</span>
    <span class="c1"># ensure the number of groups is larger than the number of clients</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_clients</span><span class="p">:</span>
        <span class="c1"># find the group with the largest size</span>
        <span class="n">groups_lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))]</span>
        <span class="n">max_gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
        <span class="c1"># set the size of the new group</span>
        <span class="n">min_glen</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
        <span class="n">max_glen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_glen</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">min_glen</span><span class="p">:</span> <span class="n">min_glen</span> <span class="o">=</span> <span class="n">max_glen</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="c1"># split the group with the largest size into two groups</span>
        <span class="n">nodes_in_gi</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">max_gi</span><span class="p">]</span>
        <span class="n">new_group_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
        <span class="n">groups</span><span class="p">[</span><span class="n">new_group_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_in_gi</span><span class="p">[:</span><span class="n">min_glen</span><span class="p">]</span>
        <span class="n">groups</span><span class="p">[</span><span class="n">max_gi</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_in_gi</span><span class="p">[</span><span class="n">min_glen</span><span class="p">:]</span>
    <span class="c1"># allocate different groups to clients</span>
    <span class="n">groups_lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))]</span>
    <span class="n">group_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">groups_lens</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">gi</span> <span class="ow">in</span> <span class="n">group_ids</span><span class="p">:</span>
        <span class="n">cid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">li</span><span class="p">)</span> <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">local_nodes</span><span class="p">])</span>
        <span class="n">local_nodes</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">gi</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">local_nodes</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner" class="doc doc-heading">
        <code>VerticalSplittedPartitioner</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="flgo.benchmark.toolkits.partition.BasicPartitioner" href="#flgo.benchmark.toolkits.partition.BasicPartitioner">BasicPartitioner</a></code></p>

  
      <p>`Partition the indices and shapes of samples in the original dataset for vertical federated learning. Different
to the above partitioners, the partitioner.<strong>call</strong> returns more flexible partition information instead of the indices that
can be used to rebuild the partitioned data.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_parties</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of parties</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>imbalance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>the degree of imbalance of the number of features</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the dim of features to be partitioned</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">VerticalSplittedPartitioner</span><span class="p">(</span><span class="n">BasicPartitioner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`Partition the indices and shapes of samples in the original dataset for vertical federated learning. Different</span>
<span class="sd">    to the above partitioners, the partitioner.__call__ returns more flexible partition information instead of the indices that</span>
<span class="sd">    can be used to rebuild the partitioned data.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_parties (int, optional): the number of parties</span>
<span class="sd">        imbalance (float, optional): the degree of imbalance of the number of features</span>
<span class="sd">        dim (int, optional): the dim of features to be partitioned</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_parties</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_parties</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_parties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span> <span class="o">=</span> <span class="n">imbalance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_pointers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;vertical_splitted_IBM</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">local_datas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_parties</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_parties</span><span class="p">)</span>
        <span class="n">feature_sizes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_feature_size</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_parties</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imbalance</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_parties</span><span class="p">):</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample_idxs&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))),</span> <span class="s1">&#39;pt_feature&#39;</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">feature_sizes</span><span class="p">,</span> <span class="n">pid</span><span class="p">),</span>
                     <span class="s1">&#39;with_label&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)}</span>
            <span class="n">local_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdata</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">local_datas</span>

    <span class="k">def</span> <span class="nf">gen_feature_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_size</span><span class="p">,</span> <span class="n">num_parties</span><span class="p">,</span> <span class="n">imbalance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">size_partitions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">size_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer_k_partition</span><span class="p">(</span><span class="n">total_size</span><span class="p">,</span> <span class="n">num_parties</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">size_gen</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tmp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">size_partitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">size_partitions</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">size_partitions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">size_partitions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">imbalance</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">size_partitions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">integer_k_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;n is the integer to partition, k is the length of partitions, l is the min partition element size&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">n</span><span class="p">,)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer_k_partition</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,)</span> <span class="o">+</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="flgo.benchmark.toolkits.partition.VerticalSplittedPartitioner.integer_k_partition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">integer_k_partition</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>n is the integer to partition, k is the length of partitions, l is the min partition element size</p>

      <details class="quote">
        <summary>Source code in <code>flgo\benchmark\toolkits\partition.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">integer_k_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;n is the integer to partition, k is the length of partitions, l is the min partition element size&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="p">:</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">n</span><span class="p">,)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer_k_partition</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,)</span> <span class="o">+</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023, Zheng Wang
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/WwZzz/easyFL" target="_blank" rel="noopener" title="FLGo" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.407015b8.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>